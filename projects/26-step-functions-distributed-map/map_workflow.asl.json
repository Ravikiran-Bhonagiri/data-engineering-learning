{
    "Comment": "Distributed Map to process S3 files in parallel",
    "StartAt": "ProcessS3Files",
    "States": {
        "ProcessS3Files": {
            "Type": "Map",
            "ItemReader": {
                "Resource": "arn:aws:states:::s3:listObjectsV2",
                "Parameters": {
                    "Bucket": "my-landing-zone-bucket",
                    "Prefix": "incoming_data/"
                }
            },
            "ItemProcessor": {
                "ProcessorConfig": {
                    "Mode": "DISTRIBUTED",
                    "ExecutionType": "STANDARD"
                },
                "StartAt": "ParseFile",
                "States": {
                    "ParseFile": {
                        "Type": "Task",
                        "Resource": "arn:aws:lambda:us-east-1:123456789012:function:FileProcessor",
                        "End": true
                    }
                }
            },
            "MaxConcurrency": 1000,
            "Label": "ProcessFilesMap",
            "End": true
        }
    }
}