# Day 06: Snapshots (SCD Type 2)

**Goal:** Track historical changes to slowly changing dimensions.

---

## Create Snapshot

**File:** `snapshots/customers_snapshot.sql`
```sql
{% snapshot customers_snapshot %}

{{
    config(
      target_schema='snapshots',
      unique_key='id',
      strategy='timestamp',
      updated_at='updated_at'
    )
}}

SELECT * FROM {{ source('raw', 'customers') }}

{% endsnapshot %}
```

---

## Run Snapshot

```bash
dbt snapshot
```

---

## What Gets Created

This creates a table with:
- `dbt_valid_from` - When record became active
- `dbt_valid_to` - When record was superseded (NULL = current)
- `dbt_scd_id` - Unique snapshot ID
- All original columns

---

## Query Historical Data

```sql
-- See all historical versions of customer ID 1
SELECT *
FROM snapshots.customers_snapshot
WHERE id = 1
ORDER BY dbt_valid_from;

-- See current version only
SELECT *
FROM snapshots.customers_snapshot
WHERE id = 1 AND dbt_valid_to IS NULL;
```

---

**✅ Day 6 Complete:** You can track historical changes.  
**Next:** `02_Day_07.md` (Macros, Incremental, CI/CD) →
